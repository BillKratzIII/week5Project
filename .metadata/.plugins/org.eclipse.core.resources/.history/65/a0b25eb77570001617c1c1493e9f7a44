package com.bakery;

import java.sql.*;
import java.util.ArrayList;

public class DAO {
	// declare variables
	public static ArrayList bakeryItems = new ArrayList<>();
	static final String JDBC_DRIVER = "com.mysql.jdbc.Driver";
	static final String DB_URL = "jdbc:mysql://localhost:3306/?user=root&autoReconnect=true&useSSL=false";
	static final String USER = "root";
	static final String PASSWORD = "sesame";
	static Connection CONN = null;
	static Statement STMT = null;
	static PreparedStatement PREP_STMT = null;
	static ResultSet RES_SET = null;

	public static void connToDB() {
		System.out.println("Connecting to DB...");

		try {
			Class.forName(JDBC_DRIVER);
			CONN = DriverManager.getConnection(DB_URL, USER, PASSWORD);
			System.out.println("Connected to the database.");
		} catch (Exception e) {
			System.out.println("Failed to connect to the database.");
			e.printStackTrace();
		}
	}// connToDB()

	public static void readFromDB() {

		connToDB();

		try {

			STMT = CONN.createStatement();
			RES_SET = STMT.executeQuery("SELECT * FROM bakery.products;");

			while (RES_SET.next()) {

				bakeryItem item = new bakeryItem();

				item.setProductID(RES_SET.getString("product_id"));
				item.setType(RES_SET.getString("type"));
				item.setCalories(RES_SET.getString("calories"));
				item.setPrice(RES_SET.getString("price"));
				item.setTopping(RES_SET.getString("topping"));

				bakeryItems.add(item);

			}

			for (bakeryItem item : bakeryItems) {
				System.out.println(item);
			}

		} catch (SQLException e) {
			e.printStackTrace();
		}

	}// readFromDB()

}// class
